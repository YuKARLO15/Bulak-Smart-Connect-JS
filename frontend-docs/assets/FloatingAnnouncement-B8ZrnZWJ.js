import{j as t}from"./jsx-runtime-DDq6Xgo1.js";import{r as u}from"./iframe-yBmqwlMP.js";import{C as lr}from"./Campaign-m2S7fuqK.js";import{C as cr}from"./Close-RM-qd8Ox.js";import{a as dr}from"./announcementService-Bpougkim.js";import{g as H,b as J,c as B,e as s}from"./identifier-CbCYuAvx.js";import{u as Z,s as S,c as G,m as j,r as pr}from"./DefaultPropsProvider-9Vu8WoMj.js";import{c as K}from"./createSimplePaletteValueFilter-DSz4oJ5a.js";import{u as V}from"./useSlotProps-B3wqVGg0.js";import{B as gr}from"./CircularProgress-C5NERrHk.js";import{D as ur,a as mr,b as br}from"./DialogTitle-CmwqEeiM.js";import{I as fr}from"./IconButton-DLjMwxe5.js";import{B as F}from"./Box-BWafXuDY.js";import{T as C}from"./Typography-Ct0PCqr9.js";const Y=r=>{const a=u.useRef({});return u.useEffect(()=>{a.current=r}),a.current};function hr(r){const{badgeContent:a,invisible:o=!1,max:e=99,showZero:c=!1}=r,d=Y({badgeContent:a,max:e});let l=o;o===!1&&a===0&&!c&&(l=!0);const{badgeContent:i,max:p=e}=l?d:r,g=i&&Number(i)>p?`${p}+`:i;return{badgeContent:i,invisible:l,max:p,displayValue:g}}function vr(r){return J("MuiBadge",r)}const h=H("MuiBadge",["root","badge","dot","standard","anchorOriginTopRight","anchorOriginBottomRight","anchorOriginTopLeft","anchorOriginBottomLeft","invisible","colorError","colorInfo","colorPrimary","colorSecondary","colorSuccess","colorWarning","overlapRectangular","overlapCircular","anchorOriginTopLeftCircular","anchorOriginTopLeftRectangular","anchorOriginTopRightCircular","anchorOriginTopRightRectangular","anchorOriginBottomLeftCircular","anchorOriginBottomLeftRectangular","anchorOriginBottomRightCircular","anchorOriginBottomRightRectangular"]),I=10,$=4,xr=r=>{const{color:a,anchorOrigin:o,invisible:e,overlap:c,variant:d,classes:l={}}=r,i={root:["root"],badge:["badge",d,e&&"invisible",`anchorOrigin${s(o.vertical)}${s(o.horizontal)}`,`anchorOrigin${s(o.vertical)}${s(o.horizontal)}${s(c)}`,`overlap${s(c)}`,a!=="default"&&`color${s(a)}`]};return G(i,vr,l)},yr=S("span",{name:"MuiBadge",slot:"Root",overridesResolver:(r,a)=>a.root})({position:"relative",display:"inline-flex",verticalAlign:"middle",flexShrink:0}),Cr=S("span",{name:"MuiBadge",slot:"Badge",overridesResolver:(r,a)=>{const{ownerState:o}=r;return[a.badge,a[o.variant],a[`anchorOrigin${s(o.anchorOrigin.vertical)}${s(o.anchorOrigin.horizontal)}${s(o.overlap)}`],o.color!=="default"&&a[`color${s(o.color)}`],o.invisible&&a.invisible]}})(j(({theme:r})=>({display:"flex",flexDirection:"row",flexWrap:"wrap",justifyContent:"center",alignContent:"center",alignItems:"center",position:"absolute",boxSizing:"border-box",fontFamily:r.typography.fontFamily,fontWeight:r.typography.fontWeightMedium,fontSize:r.typography.pxToRem(12),minWidth:I*2,lineHeight:1,padding:"0 6px",height:I*2,borderRadius:I,zIndex:1,transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.enteringScreen}),variants:[...Object.entries(r.palette).filter(K(["contrastText"])).map(([a])=>({props:{color:a},style:{backgroundColor:(r.vars||r).palette[a].main,color:(r.vars||r).palette[a].contrastText}})),{props:{variant:"dot"},style:{borderRadius:$,height:$*2,minWidth:$*2,padding:0}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="rectangular",style:{top:0,right:0,transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${h.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="rectangular",style:{bottom:0,right:0,transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${h.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="rectangular",style:{top:0,left:0,transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${h.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="rectangular",style:{bottom:0,left:0,transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${h.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="circular",style:{top:"14%",right:"14%",transform:"scale(1) translate(50%, -50%)",transformOrigin:"100% 0%",[`&.${h.invisible}`]:{transform:"scale(0) translate(50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="right"&&a.overlap==="circular",style:{bottom:"14%",right:"14%",transform:"scale(1) translate(50%, 50%)",transformOrigin:"100% 100%",[`&.${h.invisible}`]:{transform:"scale(0) translate(50%, 50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="top"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="circular",style:{top:"14%",left:"14%",transform:"scale(1) translate(-50%, -50%)",transformOrigin:"0% 0%",[`&.${h.invisible}`]:{transform:"scale(0) translate(-50%, -50%)"}}},{props:({ownerState:a})=>a.anchorOrigin.vertical==="bottom"&&a.anchorOrigin.horizontal==="left"&&a.overlap==="circular",style:{bottom:"14%",left:"14%",transform:"scale(1) translate(-50%, 50%)",transformOrigin:"0% 100%",[`&.${h.invisible}`]:{transform:"scale(0) translate(-50%, 50%)"}}},{props:{invisible:!0},style:{transition:r.transitions.create("transform",{easing:r.transitions.easing.easeInOut,duration:r.transitions.duration.leavingScreen})}}]})));function W(r){return{vertical:(r==null?void 0:r.vertical)??"top",horizontal:(r==null?void 0:r.horizontal)??"right"}}const Or=u.forwardRef(function(a,o){const e=Z({props:a,name:"MuiBadge"}),{anchorOrigin:c,className:d,classes:l,component:i,components:p={},componentsProps:g={},children:O,overlap:v="rectangular",color:x="default",invisible:n=!1,max:m=99,badgeContent:b,slots:f,slotProps:y,showZero:A=!1,variant:N="standard",...q}=e,{badgeContent:T,invisible:Q,max:X,displayValue:rr}=hr({max:m,invisible:n,badgeContent:b,showZero:A}),ar=Y({anchorOrigin:W(c),color:x,overlap:v,variant:N,badgeContent:b}),D=Q||T==null&&N!=="dot",{color:or=x,overlap:tr=v,anchorOrigin:nr,variant:k=N}=D?ar:e,er=W(nr),w=k!=="dot"?rr:void 0,P={...e,badgeContent:T,invisible:D,max:X,displayValue:w,showZero:A,anchorOrigin:er,color:or,overlap:tr,variant:k},L=xr(P),M=(f==null?void 0:f.root)??p.Root??yr,U=(f==null?void 0:f.badge)??p.Badge??Cr,R=(y==null?void 0:y.root)??g.root,z=(y==null?void 0:y.badge)??g.badge,ir=V({elementType:M,externalSlotProps:R,externalForwardedProps:q,additionalProps:{ref:o,as:i},ownerState:P,className:B(R==null?void 0:R.className,L.root,d)}),sr=V({elementType:U,externalSlotProps:z,ownerState:P,className:B(L.badge,z==null?void 0:z.className)});return t.jsxs(M,{...ir,children:[O,t.jsx(U,{...sr,children:w})]})});function Fr(r){return J("MuiFab",r)}const E=H("MuiFab",["root","primary","secondary","extended","circular","focusVisible","disabled","colorInherit","sizeSmall","sizeMedium","sizeLarge","info","error","warning","success"]),Rr=r=>{const{color:a,variant:o,classes:e,size:c}=r,d={root:["root",o,`size${s(c)}`,a==="inherit"?"colorInherit":a]},l=G(d,Fr,e);return{...e,...l}},zr=S(gr,{name:"MuiFab",slot:"Root",shouldForwardProp:r=>pr(r)||r==="classes",overridesResolver:(r,a)=>{const{ownerState:o}=r;return[a.root,a[o.variant],a[`size${s(o.size)}`],o.color==="inherit"&&a.colorInherit,a[s(o.size)],a[o.color]]}})(j(({theme:r})=>{var a,o;return{...r.typography.button,minHeight:36,transition:r.transitions.create(["background-color","box-shadow","border-color"],{duration:r.transitions.duration.short}),borderRadius:"50%",padding:0,minWidth:0,width:56,height:56,zIndex:(r.vars||r).zIndex.fab,boxShadow:(r.vars||r).shadows[6],"&:active":{boxShadow:(r.vars||r).shadows[12]},color:r.vars?r.vars.palette.text.primary:(o=(a=r.palette).getContrastText)==null?void 0:o.call(a,r.palette.grey[300]),backgroundColor:(r.vars||r).palette.grey[300],"&:hover":{backgroundColor:(r.vars||r).palette.grey.A100,"@media (hover: none)":{backgroundColor:(r.vars||r).palette.grey[300]},textDecoration:"none"},[`&.${E.focusVisible}`]:{boxShadow:(r.vars||r).shadows[6]},variants:[{props:{size:"small"},style:{width:40,height:40}},{props:{size:"medium"},style:{width:48,height:48}},{props:{variant:"extended"},style:{borderRadius:48/2,padding:"0 16px",width:"auto",minHeight:"auto",minWidth:48,height:48}},{props:{variant:"extended",size:"small"},style:{width:"auto",padding:"0 8px",borderRadius:34/2,minWidth:34,height:34}},{props:{variant:"extended",size:"medium"},style:{width:"auto",padding:"0 16px",borderRadius:40/2,minWidth:40,height:40}},{props:{color:"inherit"},style:{color:"inherit"}}]}}),j(({theme:r})=>({variants:[...Object.entries(r.palette).filter(K(["dark","contrastText"])).map(([a])=>({props:{color:a},style:{color:(r.vars||r).palette[a].contrastText,backgroundColor:(r.vars||r).palette[a].main,"&:hover":{backgroundColor:(r.vars||r).palette[a].dark,"@media (hover: none)":{backgroundColor:(r.vars||r).palette[a].main}}}}))]})),j(({theme:r})=>({[`&.${E.disabled}`]:{color:(r.vars||r).palette.action.disabled,boxShadow:(r.vars||r).shadows[0],backgroundColor:(r.vars||r).palette.action.disabledBackground}}))),jr=u.forwardRef(function(a,o){const e=Z({props:a,name:"MuiFab"}),{children:c,className:d,color:l="default",component:i="button",disabled:p=!1,disableFocusRipple:g=!1,focusVisibleClassName:O,size:v="large",variant:x="circular",...n}=e,m={...e,color:l,component:i,disabled:p,disableFocusRipple:g,size:v,variant:x},b=Rr(m);return t.jsx(zr,{className:B(b.root,d),component:i,disabled:p,focusRipple:!g,focusVisibleClassName:B(b.focusVisible,O),ownerState:m,ref:o,...n,classes:b,children:c})}),_="SeenAnnouncementIdsFab",Br=()=>{const[r,a]=u.useState(!1),[o,e]=u.useState([]),[c,d]=u.useState(!0),[l,i]=u.useState(null),[p,g]=u.useState(0),O=()=>{const n=localStorage.getItem(_);return n?JSON.parse(n):[]},v=n=>{localStorage.setItem(_,JSON.stringify(n))};u.useEffect(()=>{d(!0),dr.getRecentAnnouncements(20).then(n=>{e(n),i(null);const m=O(),b=n.filter(f=>!m.includes(f.id));g(b.length)}).catch(()=>{i("Failed to load announcements"),e([]),g(0)}).finally(()=>d(!1))},[r]),u.useEffect(()=>{if(r&&o.length>0){const n=o.map(m=>m.id);v(n),g(0)}},[r]);const x=n=>{try{return new Date(n).toLocaleDateString("en-US",{year:"numeric",month:"long",day:"numeric",hour:"2-digit",minute:"2-digit"})}catch{return"Invalid date"}};return t.jsxs(t.Fragment,{children:[t.jsx(Or,{badgeContent:p,color:"error",overlap:"circular",className:"BadgeFab",anchorOrigin:{vertical:"top",horizontal:"right"},children:t.jsx(jr,{color:"primary","aria-label":"announcements",onClick:()=>a(!0),className:"FabButtonFab",children:t.jsx(lr,{})})}),t.jsxs(ur,{open:r,onClose:()=>a(!1),PaperProps:{className:"DialogFab"},children:[t.jsxs(mr,{className:"DialogTitleFab",children:[t.jsx("span",{children:"Announcements"}),t.jsx(fr,{"aria-label":"close",onClick:()=>a(!1),size:"small",sx:{color:"#fff"},children:t.jsx(cr,{})})]}),t.jsx(br,{className:"DialogContentFab",dividers:!0,children:c?t.jsx(F,{className:"CenteredFab",children:t.jsx(C,{variant:"body2",color:"text.secondary",children:"Loading announcements..."})}):l?t.jsx(F,{className:"CenteredFab",children:t.jsx(C,{color:"error",children:l})}):o.length===0?t.jsx(F,{className:"CenteredFab",children:t.jsx(C,{children:"No announcements at the moment."})}):t.jsx(F,{className:"AnnouncementListFab",children:o.map(n=>t.jsxs(F,{className:"AnnouncementItemFab",children:[t.jsx(C,{variant:"subtitle2",className:"AnnouncementTitleFab",children:n.title}),t.jsx(C,{variant:"body2",className:"AnnouncementDescriptionFab",children:n.description}),n.image&&t.jsx("img",{src:n.image,alt:"Announcement",className:"AnnouncementImageFab"}),t.jsxs(C,{variant:"caption",className:"AnnouncementDateFab",children:["Posted: ",x(n.createdAt)]})]},n.id))})})]})]})};Br.__docgenInfo={description:"",methods:[],displayName:"FloatingAnnouncementFab"};export{Br as F};
