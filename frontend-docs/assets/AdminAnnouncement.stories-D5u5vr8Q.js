import{j as o}from"./jsx-runtime-I5Fx8Z9e.js";import{r as i}from"./iframe-3DMTuFmU.js";import{A as _}from"./AnnouncementForm-ihaIGFWU.js";import{A as w}from"./AnnouncementFeed-DVjY9tCm.js";import{E as I}from"./EditAnnouncementModal-DHB5l5-V.js";import{a as d}from"./announcementService-Bpougkim.js";import{N as b}from"./NavSide-C90ODoCx.js";import"./AnnouncementPost-BHvUBWVX.js";import"./index-xsH4HHeE.js";import"./AuthContext-CXKVu466.js";import"./createSvgIcon-BLDxFBmY.js";import"./clsx-B-dksMZM.js";import"./DefaultPropsProvider-Bcev3kPu.js";import"./createTheme-BEjq_8i9.js";import"./Close-DGlxePoy.js";import"./Description-CUYdnb3H.js";import"./chunk-AYJ5UCUI-CUH48NyS.js";const p=()=>{const[m,a]=i.useState([{id:1,title:"System Update",description:"New features available!",date:"2025-04-20T10:00",image:""},{id:2,title:"Team Meeting",description:"Scheduled for Friday 10 AM",date:"2025-04-18T10:00",image:""}]),[S,h]=i.useState(!1),[y,c]=i.useState(!1),[j,l]=i.useState(null),[D,u]=i.useState(!1);i.useEffect(()=>{E()},[]);const E=async()=>{try{u(!0);const e=(await d.getAllAnnouncements()).map(n=>({id:n.id,title:n.title,description:n.description,date:n.createdAt,image:n.image||""}));e.length>0&&a(e)}catch(t){console.error("Failed to load announcements:",t),console.log("Using fallback data due to API error")}finally{u(!1)}},v=async t=>{try{const e=await d.createAnnouncement(t),n={id:e.id,title:e.title,description:e.description,date:e.createdAt,image:e.image||""};a([n,...m])}catch(e){console.error("Failed to create announcement:",e);const n={...t,id:Date.now(),date:new Date().toISOString()};a([n,...m])}},F=t=>{l(t),c(!0)},N=async t=>{try{const e=await d.updateAnnouncement(t.id,{title:t.title,description:t.description,image:t.image}),n={id:e.id,title:e.title,description:e.description,date:e.updatedAt,image:e.image||""};a(s=>s.map(f=>f.id===n.id?n:f))}catch(e){console.error("Failed to update announcement:",e),a(n=>n.map(s=>s.id===t.id?t:s))}c(!1),l(null)},O=async t=>{try{await d.deleteAnnouncement(t),a(e=>e.filter(n=>n.id!==t))}catch(e){console.error("Failed to delete announcement:",e),a(n=>n.filter(s=>s.id!==t))}c(!1),l(null)};return o.jsxs("div",{className:"announcement-container",children:[o.jsx("h2",{children:"Bulak LGU Smart Announcements"}),o.jsx(b,{isSidebarOpen:S,setIsSidebarOpen:h}),D&&o.jsx("div",{style:{textAlign:"center",padding:"20px"},children:"Loading announcements..."}),o.jsxs("div",{className:"announcement-main",children:[o.jsx(w,{announcements:m,onEdit:F}),o.jsx(_,{addAnnouncement:v})]}),o.jsx(I,{isOpen:y,onClose:()=>c(!1),announcementData:j,onSave:N,onDelete:O})]})};p.__docgenInfo={description:"",methods:[],displayName:"AdminAnnouncement"};const W={title:"Components/AdminAnnouncement",component:p},r=()=>o.jsx(p,{});r.__docgenInfo={description:"",methods:[],displayName:"Default"};var A,g,x;r.parameters={...r.parameters,docs:{...(A=r.parameters)==null?void 0:A.docs,source:{originalSource:"() => <AdminAnnouncement />",...(x=(g=r.parameters)==null?void 0:g.docs)==null?void 0:x.source}}};const X=["Default"];export{r as Default,X as __namedExportsOrder,W as default};
