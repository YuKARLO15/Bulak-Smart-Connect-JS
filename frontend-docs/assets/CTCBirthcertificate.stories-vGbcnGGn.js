import{j as i}from"./jsx-runtime-CD0WxGN_.js";import{r as n}from"./iframe-a4ikhERS.js";import{F as S}from"./FileUpload-491xBGU8.js";import{N as w}from"./NavSide-CO-KyLg3.js";import{B as p}from"./Box-CCMUzMMw.js";import{T as s}from"./Typography-yAyBsT5_.js";import{P}from"./Paper-DQA74_z2.js";import{A as q}from"./Alert-FKvFnIwR.js";import{B as y}from"./Button-B2C3Nun9.js";import{u as E}from"./chunk-AYJ5UCUI-BhvlGKiC.js";import"./AuthContext-ChD7GsWJ.js";import"./createSvgIcon-Dt-2YBQW.js";import"./clsx-B-dksMZM.js";import"./DefaultPropsProvider-ClpNxUsI.js";import"./createTheme-B1tyInBV.js";import"./Close-B1deDlY6.js";import"./Description-CHmOSd6e.js";import"./extendSxProp-BsrRmKYi.js";import"./createSimplePaletteValueFilter-DT5_9JkI.js";import"./useTheme-LP6QFLdH.js";import"./useSlot-Brg3aKTg.js";import"./CircularProgress-CS6fCBGe.js";const d=()=>{const[u,b]=n.useState(!1),[m,v]=n.useState({}),[e,T]=n.useState({}),[j,h]=n.useState({}),[C,D]=n.useState(!1),f=E(),[O,R]=n.useState(!0),g=m["Valid ID"]===!0&&((e==null?void 0:e.purpose)!=="On behalf of someone"||m["Authorization Letter (if applicable)"]===!0);n.useEffect(()=>{try{const t=localStorage.getItem("birthCertificateApplication");t&&T(JSON.parse(t))}catch(t){console.error("Error loading form data:",t)}},[]);const B=(t,o,a)=>{console.log(`File ${t} ${o?"uploaded":"removed"}`),v(r=>({...r,[t]:o})),o&&a?(console.log("File info:",a),h(r=>({...r,[t]:a}))):(console.log(`File ${t} removed`),h(r=>{const c={...r};return delete c[t],c}))},A=()=>{if(g)try{const t=localStorage.getItem("currentApplicationId");if(!t){console.error("No application ID found"),alert("Application ID is missing. Cannot proceed.");return}console.log("Processing upload for application ID:",t);const o={...e,uploadedFiles:j},a=JSON.parse(localStorage.getItem("applications")||"[]"),r=a.findIndex(c=>c.id===t);if(r>=0)console.log(`Updating application at index ${r} with uploaded files`),a[r]={...a[r],formData:{...a[r].formData,...o},lastUpdated:new Date().toISOString()};else{console.error(`Application ID ${t} not found in applications array`),alert("Could not find your application. Please try again.");return}localStorage.setItem("applications",JSON.stringify(a)),localStorage.setItem("birthCertificateApplication",JSON.stringify(o)),console.log("Files saved successfully for application ID:",t),console.log("Updated formData:",o),window.dispatchEvent(new Event("storage")),window.dispatchEvent(new CustomEvent("customStorageUpdate",{detail:{id:t,action:"updated",type:"Birth Certificate"}})),D(!0),setTimeout(()=>{f("/BirthApplicationSummary")},2e3)}catch(t){console.error("Error submitting application:",t),alert("Error submitting application. Please try again.")}else alert("Please upload the required documents before submitting.")},F=()=>{f("/RequestACopyBirthCertificate")};return i.jsxs(p,{className:`MainContainerCTCBirth ${u?"SidebarOpenCTCBirth":""}`,children:[i.jsx(w,{isSidebarOpen:u,setIsSidebarOpen:b}),i.jsx(s,{variant:"h4",className:"TitleCTCBirth",children:"Upload Required Documents"}),i.jsx(s,{variant:"subtitle1",className:"SubtitleCTCBirth",children:"Please upload the following documents to complete your birth certificate copy request"}),i.jsxs(P,{elevation:3,className:"DocumentsPaperCTCBirth",children:[i.jsxs(p,{className:"ApplicantInfoCTCBirth",children:[i.jsx(s,{variant:"h6",children:"Applicant Information"}),i.jsxs(s,{variant:"body1",children:["Name: ",(e==null?void 0:e.firstName)||""," ",(e==null?void 0:e.middleName)||""," ",(e==null?void 0:e.lastName)||""]}),i.jsxs(s,{variant:"body1",children:["Date of Birth: ",(e==null?void 0:e.birthMonth)||""," ",(e==null?void 0:e.birthDay)||"",","," ",(e==null?void 0:e.birthYear)||""]}),i.jsxs(s,{variant:"body1",children:["Purpose: ",(e==null?void 0:e.purpose)||"Not specified"]})]}),i.jsx(s,{variant:"h6",className:"RequirementsHeaderCTCBirth",children:"Required Documents"}),i.jsxs(p,{className:"DocumentsListCTCBirth",children:[i.jsx(S,{label:"Valid ID",onUpload:(t,o)=>B("Valid ID",t,o),required:!0}),i.jsx(s,{variant:"caption",className:"DocumentDescriptionCTCBirth",children:"Please upload a clear copy of any valid government-issued ID (e.g., Driver's License, Passport, PhilSys ID)"}),i.jsx(S,{label:"Authorization Letter (if applicable)",onUpload:(t,o)=>B("Authorization Letter (if applicable)",t,o),required:!1}),i.jsx(s,{variant:"caption",className:"DocumentDescriptionCTCBirth",children:"If you are requesting on behalf of someone else, please upload a signed authorization letter and your valid ID"})]}),C&&i.jsx(q,{severity:"success",className:"SuccessAlertCTCBirth",children:"Your application has been submitted successfully! Redirecting to summary..."}),i.jsxs(p,{className:"ButtonContainerCTCBirth",children:[i.jsx(y,{variant:"outlined",color:"primary",onClick:F,className:"BackButtonCTCBirth",children:"Back"}),i.jsx(y,{variant:"contained",color:"primary",onClick:A,className:"SubmitButtonCTCBirth",disabled:!g||C,children:"Submit Application"})]})]})]})};d.__docgenInfo={description:"",methods:[],displayName:"CTCBirthCertificate"};const ae={title:"Components/CTCBirthcertificate",component:d},l=()=>i.jsx(d,{});l.__docgenInfo={description:"",methods:[],displayName:"Default"};var x,I,N;l.parameters={...l.parameters,docs:{...(x=l.parameters)==null?void 0:x.docs,source:{originalSource:"() => <CTCBirthcertificate />",...(N=(I=l.parameters)==null?void 0:I.docs)==null?void 0:N.source}}};const se=["Default"];export{l as Default,se as __namedExportsOrder,ae as default};
