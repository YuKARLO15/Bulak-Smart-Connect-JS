import{j as a}from"./jsx-runtime-Ds-gkUgj.js";import{r as c}from"./index-CtvPRVHf.js";import{A as N}from"./AnnouncementForm-D4AL3N4k.js";import{A as O}from"./AnnouncementFeed-BKkfsG_d.js";import{E as b}from"./EditAnnouncementModal-DSkHXmx0.js";import{a as i}from"./index-xsH4HHeE.js";import{N as M}from"./NavSide-CqY9HB19.js";import"./AnnouncementPost-CvqH8ibf.js";import"./AuthContext-DROsejNy.js";import"./createSvgIcon-C90RuxAZ.js";import"./clsx-B-dksMZM.js";import"./DefaultPropsProvider-D010D3ru.js";import"./createTheme-C6kIcmbg.js";import"./Close-BFUA1JaJ.js";import"./Description-VtskB8YN.js";import"./chunk-AYJ5UCUI-CkRdRQ96.js";const d="http://localhost:3000",p={async getAllAnnouncements(){try{return(await i.get(`${d}/announcements`)).data}catch(r){throw console.error("Error fetching announcements:",r),r}},async getRecentAnnouncements(r=5){try{return(await i.get(`${d}/announcements/recent?limit=${r}`)).data}catch(e){throw console.error("Error fetching recent announcements:",e),e}},async getAnnouncementById(r){try{return(await i.get(`${d}/announcements/${r}`)).data}catch(e){throw console.error("Error fetching announcement:",e),e}},async createAnnouncement(r){try{return(await i.post(`${d}/announcements`,r)).data}catch(e){throw console.error("Error creating announcement:",e),e}},async updateAnnouncement(r,e){try{return(await i.patch(`${d}/announcements/${r}`,e)).data}catch(m){throw console.error("Error updating announcement:",m),m}},async deleteAnnouncement(r){try{return await i.delete(`${d}/announcements/${r}`),!0}catch(e){throw console.error("Error deleting announcement:",e),e}}},f=()=>{const[r,e]=c.useState([{id:1,title:"System Update",description:"New features available!",date:"2025-04-20T10:00",image:""},{id:2,title:"Team Meeting",description:"Scheduled for Friday 10 AM",date:"2025-04-18T10:00",image:""}]),[m,S]=c.useState(!1),[E,u]=c.useState(!1),[j,A]=c.useState(null),[$,g]=c.useState(!1);c.useEffect(()=>{D()},[]);const D=async()=>{try{g(!0);const n=(await p.getAllAnnouncements()).map(o=>({id:o.id,title:o.title,description:o.description,date:o.createdAt,image:o.image||""}));n.length>0&&e(n)}catch(t){console.error("Failed to load announcements:",t),console.log("Using fallback data due to API error")}finally{g(!1)}},_=async t=>{try{const n=await p.createAnnouncement(t),o={id:n.id,title:n.title,description:n.description,date:n.createdAt,image:n.image||""};e([o,...r])}catch(n){console.error("Failed to create announcement:",n);const o={...t,id:Date.now(),date:new Date().toISOString()};e([o,...r])}},v=t=>{A(t),u(!0)},I=async t=>{try{const n=await p.updateAnnouncement(t.id,{title:t.title,description:t.description,image:t.image}),o={id:n.id,title:n.title,description:n.description,date:n.updatedAt,image:n.image||""};e(s=>s.map(h=>h.id===o.id?o:h))}catch(n){console.error("Failed to update announcement:",n),e(o=>o.map(s=>s.id===t.id?t:s))}u(!1),A(null)},F=async t=>{try{await p.deleteAnnouncement(t),e(n=>n.filter(o=>o.id!==t))}catch(n){console.error("Failed to delete announcement:",n),e(o=>o.filter(s=>s.id!==t))}u(!1),A(null)};return a.jsxs("div",{className:"announcement-container",children:[a.jsx("h2",{children:"Bulak LGU Smart Announcements"}),a.jsx(M,{isSidebarOpen:m,setIsSidebarOpen:S}),$&&a.jsx("div",{style:{textAlign:"center",padding:"20px"},children:"Loading announcements..."}),a.jsxs("div",{className:"announcement-main",children:[a.jsx(O,{announcements:r,onEdit:v}),a.jsx(N,{addAnnouncement:_})]}),a.jsx(b,{isOpen:E,onClose:()=>u(!1),announcementData:j,onSave:I,onDelete:F})]})};f.__docgenInfo={description:"",methods:[],displayName:"AdminAnnouncement"};const W={title:"Components/AdminAnnouncement",component:f},l=()=>a.jsx(f,{});l.__docgenInfo={description:"",methods:[],displayName:"Default"};var y,w,x;l.parameters={...l.parameters,docs:{...(y=l.parameters)==null?void 0:y.docs,source:{originalSource:"() => <AdminAnnouncement />",...(x=(w=l.parameters)==null?void 0:w.docs)==null?void 0:x.source}}};const X=["Default"];export{l as Default,X as __namedExportsOrder,W as default};
