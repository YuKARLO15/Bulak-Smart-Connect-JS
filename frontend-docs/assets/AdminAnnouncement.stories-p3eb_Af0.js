import{j as o}from"./jsx-runtime-ADgNcF8R.js";import{r as i}from"./iframe-DK1y04Ng.js";import{A as _}from"./AnnouncementForm-fPQyitv3.js";import{A as w}from"./AnnouncementFeed-D6h6WXz4.js";import{E as I}from"./EditAnnouncementModal-ZWEQcRaN.js";import{a as d}from"./announcementService-Bpougkim.js";import{N as b}from"./NavSide-ByT1T0FM.js";import"./AnnouncementPost-xtDXORnp.js";import"./index-xsH4HHeE.js";import"./AuthContext-DzYDWVWZ.js";import"./createSvgIcon-BYikzphh.js";import"./clsx-B-dksMZM.js";import"./DefaultPropsProvider-DJcgvS5y.js";import"./identifier-BVXmwU02.js";import"./Close-C-jf9Jsl.js";import"./Description-DkJFw6Gx.js";import"./Campaign-BizuL4VV.js";import"./chunk-AYJ5UCUI-BNhOGDwc.js";const p=()=>{const[m,a]=i.useState([{id:1,title:"System Update",description:"New features available!",date:"2025-04-20T10:00",image:""},{id:2,title:"Team Meeting",description:"Scheduled for Friday 10 AM",date:"2025-04-18T10:00",image:""}]),[x,S]=i.useState(!1),[y,c]=i.useState(!1),[j,l]=i.useState(null),[D,u]=i.useState(!1);i.useEffect(()=>{E()},[]);const E=async()=>{try{u(!0);const e=(await d.getAllAnnouncements()).map(n=>({id:n.id,title:n.title,description:n.description,date:n.createdAt,image:n.image||""}));e.length>0&&a(e)}catch(t){console.error("Failed to load announcements:",t),console.log("Using fallback data due to API error")}finally{u(!1)}},v=async t=>{try{const e=await d.createAnnouncement(t),n={id:e.id,title:e.title,description:e.description,date:e.createdAt,image:e.image||""};a([n,...m])}catch(e){console.error("Failed to create announcement:",e);const n={...t,id:Date.now(),date:new Date().toISOString()};a([n,...m])}},N=t=>{l(t),c(!0)},F=async t=>{try{const e=await d.updateAnnouncement(t.id,{title:t.title,description:t.description,image:t.image}),n={id:e.id,title:e.title,description:e.description,date:e.updatedAt,image:e.image||""};a(s=>s.map(f=>f.id===n.id?n:f))}catch(e){console.error("Failed to update announcement:",e),a(n=>n.map(s=>s.id===t.id?t:s))}c(!1),l(null)},O=async t=>{try{await d.deleteAnnouncement(t),a(e=>e.filter(n=>n.id!==t))}catch(e){console.error("Failed to delete announcement:",e),a(n=>n.filter(s=>s.id!==t))}c(!1),l(null)};return o.jsxs("div",{className:"announcement-container",children:[o.jsxs("h1",{className:"announcement-h2",children:["Bulak LGU Smart Announcements",o.jsx(b,{isSidebarOpen:x,setIsSidebarOpen:S})]}),D&&o.jsx("div",{style:{textAlign:"center",padding:"20px"},children:"Loading announcements..."}),o.jsxs("div",{className:"announcement-main",children:[o.jsx(w,{announcements:m,onEdit:N}),o.jsx(_,{addAnnouncement:v})]}),o.jsx(I,{isOpen:y,onClose:()=>c(!1),announcementData:j,onSave:F,onDelete:O})]})};p.__docgenInfo={description:"",methods:[],displayName:"AdminAnnouncement"};const X={title:"Components/AdminAnnouncement",component:p},r=()=>o.jsx(p,{});r.__docgenInfo={description:"",methods:[],displayName:"Default"};var A,g,h;r.parameters={...r.parameters,docs:{...(A=r.parameters)==null?void 0:A.docs,source:{originalSource:"() => <AdminAnnouncement />",...(h=(g=r.parameters)==null?void 0:g.docs)==null?void 0:h.source}}};const Y=["Default"];export{r as Default,Y as __namedExportsOrder,X as default};
