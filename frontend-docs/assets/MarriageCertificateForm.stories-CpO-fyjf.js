import{j as e}from"./jsx-runtime-ADgNcF8R.js";import{r as s}from"./iframe-DK1y04Ng.js";/* empty css                                */import{H as K}from"./HusbandForm-CQP7ptxG.js";import{W as Q}from"./WifeForm-f-gocIRm.js";import{M as X}from"./MarriageDetailsForm-BZ38G5L9.js";import{M as Z}from"./MarriageAffidavitForm-DJ0qIZY6.js";import{a as ee,u as ae,b as te}from"./ApplicationData-DCHunuve.js";import{B as b}from"./Box-DDoIQZtm.js";import{D as ie,a as re,b as oe}from"./DialogTitle-BQi8SxCC.js";import{D as se}from"./DialogContentText-D1cW3QSJ.js";import{D as ne}from"./DialogActions-vUTOAxPN.js";import{B as c}from"./Button-Jf2bfJLe.js";import{T as L}from"./Typography-CYdwMn8V.js";import{A as le}from"./Alert-B7wIDnj4.js";import{P as ce}from"./Paper-DbVLDYSJ.js";import{u as de}from"./chunk-AYJ5UCUI-BNhOGDwc.js";import"./identifier-BVXmwU02.js";import"./clsx-B-dksMZM.js";import"./useTheme-DkEzB1vm.js";import"./useTheme-nvBBIMAU.js";import"./DefaultPropsProvider-DJcgvS5y.js";import"./useSlot-BJiBpOaU.js";import"./CircularProgress-DGUkJBVb.js";import"./createSimplePaletteValueFilter-Dpj8v-sF.js";import"./Modal-CVtsMCL8.js";import"./utils-CvarN4_O.js";import"./index-C4iB9re7.js";import"./index-CXvut8Jt.js";import"./createChainedFunction-BO_9K8Jh.js";import"./createSvgIcon-BYikzphh.js";import"./IconButton-TKqQSHg8.js";const j=()=>{const[n,I]=s.useState(1),[r,C]=s.useState({}),[g,A]=s.useState({}),[l,O]=s.useState(""),[m,W]=s.useState(4),[$,U]=s.useState(!1),[me,R]=s.useState(!1),[F,z]=s.useState(null),[_,y]=s.useState(!1),[B,q]=s.useState(!1),v=de();s.useEffect(()=>{const a=localStorage.getItem("isEditingMarriageForm")==="true",t=localStorage.getItem("selectedMarriageOption");t?(O(t),W(t==="Marriage License"?2:4),t==="Marriage Certificate"&&!a&&H()):v("/MarriageDashboard");const i=localStorage.getItem("editingMarriageType");if(a&&(!i||i===t)){const o=localStorage.getItem("marriageFormData");if(o)try{const d=JSON.parse(o);C(d),d.husbandCivilStatus==="Widowed"&&setShowHusbandWidowedFields(!0),d.wifeCivilStatus==="Widowed"&&setShowWifeWidowedFields(!0),console.log(`Loaded existing ${t} data for editing`)}catch(d){console.error("Error loading marriage form data for editing:",d)}}},[v]);const H=()=>{try{const a=ee("Marriage License");if(a&&a.length>0){a.sort((i,o)=>new Date(o.date)-new Date(i.date));const t=a[0];t.formData&&(R(!0),z(t),y(!0))}}catch(a){console.error("Error checking for previous license data:",a)}},J=()=>{C(F.formData),U(!0),y(!1),console.log("Using data from previous Marriage License:",F.id)},V=()=>{y(!1),console.log("User chose to fill out a new form")},S=a=>{const{name:t,value:i,type:o,checked:d}=a.target;C(f=>({...f,[t]:o==="checkbox"?d:i})),g[t]&&A(f=>({...f,[t]:""}))},Y={1:["husbandFirstName","husbandLastName","husbandBirthMonth","husbandBirthDay","husbandBirthYear","husbandBirthCity","husbandBirthProvince","husbandBirthCountry","husbandSex","husbandFatherFirstName","husbandFatherLastName","husbandMotherFirstName","husbandMotherLastName","husbandStreet","husbandCity","husbandProvince","husbandCivilStatus","husbandCountry","husbandReligion","husbandCitizenship","husbandBarangay","husbandFatherCitizenship","husbandMotherCitizenship","waliFirstName","waliLastName","waliRelationship","waliStreet","waliCity","waliProvince","waliCountry","waliBarangay","husbandAge"],2:["wifeFirstName","wifeLastName","wifeBirthMonth","wifeBirthDay","wifeBirthYear","wifeBirthCity","wifeBirthProvince","wifeBirthCountry","wifeSex","wifeFatherFirstName","wifeFatherLastName","wifeMotherFirstName","wifeMotherLastName","wifeStreet","wifeCity","wifeProvince","wifeCivilStatus","wifeCountry","wifeReligion","wifeCitizenship","wifeBarangay","wifeFatherCitizenship","wifeMotherCitizenship","wifewaliFirstName","wifewaliLastName","wifewaliRelationship","wifewaliStreet","wifewaliCity","wifewaliProvince","wifewaliCountry","wifewaliBarangay","wifeAge"],3:["marriageOffice","marriageBarangay","marriageCity","marriageProvince","marriageCountry","marriageMonth","marriageDay","marriageYear","marriageTime"],4:["witness1FirstName","witness1LastName","witness1Address","witness2FirstName","witness2LastName","witness2Address"]},G=()=>{var t;const a={};return(t=Y[n])==null||t.forEach(i=>{(!r[i]||r[i].toString().trim()==="")&&(a[i]="This field is required")}),A(a),Object.keys(a).length===0},D=()=>{if(G())n<m?I(a=>a+1):N();else{const a=document.querySelector(`[name="${Object.keys(g)[0]}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})}},M=()=>{I(a=>a-1)},N=a=>{if(a&&a.preventDefault&&a.preventDefault(),n===4&&!B){const t=document.querySelector(".affidavit-form1-container");if(t){const i=new Event("submit",{cancelable:!0});if(t.dispatchEvent(i),i.defaultPrevented)return}return}try{console.log("==== MARRIAGE FORM SUBMISSION ====");const t=localStorage.getItem("isEditingMarriageForm")==="true",i=localStorage.getItem("currentEditingApplicationId");console.log("Is editing mode?",t),console.log("Editing ID:",i);let o;t&&i?(o=i,console.log("Using existing ID for edit:",o)):(o=l==="Marriage License"?"ML-"+Date.now().toString().slice(-6):"MC-"+Date.now().toString().slice(-6),console.log("Generated new ID:",o));const f=new Date().toLocaleDateString("en-US",{year:"numeric",month:"numeric",day:"numeric"});let u;if(t&&i){const p=JSON.parse(localStorage.getItem("applications")||"[]").find(w=>w.id===i);if(!p){console.error("Could not find application with ID:",i),alert("Error: Could not find the application you are trying to edit.");return}console.log("Found existing application:",p),u={id:o,type:l||p.type,applicationType:"Modified Application",date:p.date||f,status:p.status||"Pending",message:`Application for ${l||"marriage"} between ${r.husbandFirstName||""} ${r.husbandLastName||""} and ${r.wifeFirstName||""} ${r.wifeLastName||""}`,formData:{...r,applicationId:o,certificateType:l,lastUpdated:new Date().toISOString()},lastModified:new Date().toISOString()}}else u={id:o,type:l||"Marriage Certificate",applicationType:"New Application",date:f,status:"Pending",message:`Application for ${l||"marriage"} between ${r.husbandFirstName||""} ${r.husbandLastName||""} and ${r.wifeFirstName||""} ${r.wifeLastName||""}`,formData:{...r,applicationId:o,certificateType:l,lastUpdated:new Date().toISOString()}};console.log("Final application data to submit:",u);let h;if(t&&i){const P=JSON.parse(localStorage.getItem("applications")||"[]");console.log("Applications before update:",P.map(w=>w.id)),h=ae(i,u);const p=JSON.parse(localStorage.getItem("applications")||"[]");console.log("Applications after update:",p.map(w=>w.id)),console.log("Update result:",h)}else h=te(u),console.log("Add result:",h);if(!h){console.error("Failed to save application"),alert("There was an error saving your application. Please try again.");return}localStorage.removeItem("isEditingMarriageForm"),localStorage.removeItem("editingMarriageType"),localStorage.removeItem("currentEditingApplicationId"),localStorage.removeItem("marriageFormData"),window.dispatchEvent(new Event("storage")),v(l==="Marriage License"?"/MarriageLicenseApplication":"/MarriageCertificateApplication")}catch(t){console.error("Error submitting form:",t),alert("There was an error submitting your application. Please try again.")}};return e.jsxs(b,{className:"MarriageCertificateFormContainer",children:[e.jsxs(ie,{open:_,"aria-labelledby":"previous-data-dialog-title","aria-describedby":"previous-data-dialog-description",PaperProps:{sx:{borderRadius:"10px",maxWidth:"500px",width:"100%"}},children:[e.jsx(re,{id:"previous-data-dialog-title",sx:{backgroundColor:"#184a5b",color:"white",fontWeight:600},children:"Use Previous Marriage License Data?"}),e.jsx(oe,{sx:{padding:"24px"},children:e.jsxs(se,{id:"previous-data-dialog-description",sx:{color:"#333333",fontSize:"16px",marginBottom:"10",marginTop:"30px"},children:["We found a previous Marriage License application submitted on"," ",F&&new Date(F.date).toLocaleDateString(),". Would you like to use that information to fill out this form?"]})}),e.jsxs(ne,{sx:{padding:"16px 24px",justifyContent:"space-between"},children:[e.jsx(c,{onClick:V,sx:{backgroundColor:"#e0e0e0",color:"#333333",padding:"4px 10px",fontWeight:500},children:"No, I'll fill it out again"}),e.jsx(c,{onClick:J,autoFocus:!0,sx:{backgroundColor:"#184a5b",color:"white",padding:"4px 10px",fontWeight:500},children:"Yes, use my previous information"})]})]}),e.jsxs(L,{variant:"h4",className:"MarriageCertificateFormTitle",children:[l||"Marriage"," Application Form"]}),$&&e.jsx(le,{severity:"info",sx:{mb:2},children:"Using data from your previous Marriage License application. Please verify all information is still correct."}),e.jsxs(ce,{className:"MarriageCertificateForm",elevation:3,children:[n===1&&e.jsxs(e.Fragment,{children:[e.jsx(K,{formData:r,handleChange:S,errors:g}),e.jsx(c,{variant:"contained",onClick:D,className:"MarriageCertificateFormButton",children:"Next"})]}),n===2&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{formData:r,handleChange:S,errors:g}),e.jsx(c,{variant:"contained",onClick:M,className:"MarriageCertificateFormButton",children:"Previous"}),e.jsx(c,{variant:"contained",onClick:m===2?N:D,className:"MarriageCertificateFormButton",children:m===2?"Submit":"Next"})]}),n===3&&m>2&&e.jsxs(e.Fragment,{children:[e.jsx(X,{formData:r,handleChange:S,errors:g}),e.jsx(c,{variant:"contained",onClick:M,className:"MarriageCertificateFormButton",children:"Previous"}),e.jsx(c,{variant:"contained",onClick:D,className:"MarriageCertificateFormButton",children:"Next"})]}),n===4&&m>2&&e.jsxs(e.Fragment,{children:[e.jsx(Z,{formData:r,handleChange:S,errors:g,onValidationChange:q}),e.jsx(c,{variant:"contained",onClick:M,className:"MarriageCertificateFormButton",children:"Previous"}),e.jsx(c,{variant:"contained",onClick:N,className:"MarriageCertificateFormButton",disabled:!B,children:"Submit"})]}),e.jsxs(b,{className:"FormProgressContainer",children:[e.jsxs(L,{variant:"body2",children:["Step ",n," of ",m]}),e.jsx(b,{className:"FormProgressBar",children:e.jsx(b,{className:"FormProgressFill",sx:{width:`${n/m*100}%`}})})]})]})]})};j.__docgenInfo={description:"",methods:[],displayName:"MarriageCertificateForm"};const qe={title:"Components/MarriageCertificateForm",component:j},x=()=>e.jsx(j,{});x.__docgenInfo={description:"",methods:[],displayName:"Default"};var E,k,T;x.parameters={...x.parameters,docs:{...(E=x.parameters)==null?void 0:E.docs,source:{originalSource:"() => <MarriageCertificateForm />",...(T=(k=x.parameters)==null?void 0:k.docs)==null?void 0:T.source}}};const He=["Default"];export{x as Default,He as __namedExportsOrder,qe as default};
