import{j as e}from"./jsx-runtime-B78vVl8w.js";import{r as n}from"./iframe-TbmtwHaR.js";import{N as E}from"./NavSide-CfoPBuEY.js";import{q as W}from"./queueService-BpOaP1T5.js";import{u as A}from"./chunk-AYJ5UCUI-Ci6-IpHO.js";import"./AuthContext-DrlViolT.js";import"./createSvgIcon-C62t7wA5.js";import"./clsx-B-dksMZM.js";import"./DefaultPropsProvider-CJWLS2pt.js";import"./identifier-CcNMM8xL.js";import"./Close-CZIdNNwn.js";import"./Description-BYfF4GKI.js";import"./Campaign-BTsGxkTW.js";import"./index-xsH4HHeE.js";import"./api-DR_qaoiX.js";const d=i=>{if(typeof i=="string"&&i.startsWith("WK"))return i;if(!i)return"WK000";const m=i!=null&&i.includes("-")?i.split("-")[1]:i,c=parseInt(m,10)||0;return`WK${String(c).padStart(3,"0")}`},o=()=>{const[i,m]=n.useState(!1),[c,w]=n.useState(!1),[t,v]=n.useState([]),[r,f]=n.useState([]),[I,p]=n.useState(!0),[N,h]=n.useState(null),Q=A(),y=r.length>0?d(r[0].queueNumber||r[0].id):"None",S=t.length>0?d(t[0].queueNumber||t[0].id):"None",q=t.length+r.length,u=n.useCallback(async()=>{p(!0);try{const a=await W.fetchWalkInQueues(),b=a.filter(s=>s.status==="pending").map(s=>({id:s.id,queueNumber:d(s.queueNumber||s.id),firstName:s.firstName||"Guest",lastName:s.lastName||"",reasonOfVisit:s.reasonOfVisit||"General Inquiry",status:"pending",timestamp:s.createdAt||new Date().toISOString()})),O=a.filter(s=>s.status==="serving").map(s=>({id:s.id,queueNumber:d(s.queueNumber||s.id),firstName:s.firstName||"Guest",lastName:s.lastName||"",reasonOfVisit:s.reasonOfVisit||"General Inquiry",status:"serving",timestamp:s.createdAt||new Date().toISOString()}));v(b),f(O),h(null)}catch(a){console.error("Error fetching queue data:",a),h("Failed to load queue data. Please ensure the server is running.")}finally{p(!1)}},[]),x=a=>{Q(`/AdminWalkInDetails/${a}`)};return n.useEffect(()=>{u();const a=setInterval(u,3e4);return()=>clearInterval(a)},[u]),e.jsxs("div",{className:"admin-walkin-queue",children:[e.jsxs("div",{className:"admin-walkin-queue-header-bar",children:[e.jsx("button",{className:"admin-walkin-queue-menu-btn",onClick:()=>m(!0),"aria-label":"Open navigation",children:e.jsxs("span",{className:"admin-walkin-queue-menu-icon",children:[e.jsx("span",{className:"admin-walkin-queue-menu-bar"}),e.jsx("span",{className:"admin-walkin-queue-menu-bar"}),e.jsx("span",{className:"admin-walkin-queue-menu-bar"})]})}),e.jsx("h1",{className:"admin-walkin-queue-header-title",children:"Walk - in"})]}),e.jsx(E,{isSidebarOpen:c,setIsSidebarOpen:w}),e.jsxs("div",{className:"admin-walkin-queue-main",children:[e.jsxs("div",{className:"admin-walkin-queue-summary-row",children:[e.jsxs("div",{className:"admin-walkin-queue-summary-card",children:[e.jsx("h2",{className:"admin-walkin-queue-summary-title",children:"CURRENT QUEUE"}),e.jsx("div",{className:"admin-walkin-queue-summary-number",children:y}),e.jsxs("div",{className:"admin-walkin-queue-summary-next",children:["Next on Queue ",e.jsx("span",{className:"admin-walkin-queue-summary-next-number",children:S})]})]}),e.jsxs("div",{className:"admin-walkin-queue-summary-card gray",children:[e.jsx("h2",{className:"admin-walkin-queue-summary-title",children:"TOTAL NUMBER OF QUEUE"}),e.jsx("div",{className:"admin-walkin-queue-summary-number",children:q})]})]}),e.jsxs("div",{className:"admin-walkin-queue-list-section",children:[e.jsx("h2",{className:"admin-walkin-queue-list-title",children:"Walk - In Queues"}),I?e.jsxs("div",{style:{textAlign:"center",padding:"20px"},children:[e.jsx("div",{className:"loading-spinner"}),e.jsx("p",{children:"Loading queue data..."})]}):N?e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#721c24"},children:e.jsx("p",{children:N})}):t.length===0&&r.length===0?e.jsx("div",{style:{textAlign:"center",padding:"20px",color:"#666"},children:e.jsx("p",{children:"No active walk-in queues"})}):e.jsxs("div",{className:"admin-walkin-queue-list",children:[r.map(a=>e.jsxs("div",{className:"admin-walkin-queue-item active-queue",onClick:()=>x(a.id),children:[e.jsxs("div",{className:"admin-walkin-queue-status-section",children:[e.jsx("div",{className:"admin-walkin-queue-status",children:"IN PROGRESS"}),e.jsx("div",{className:"admin-walkin-queue-date",children:new Date(a.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("div",{className:"admin-walkin-queue-applicant",children:`${a.firstName} ${a.lastName}`}),e.jsx("div",{className:"admin-walkin-queue-id",children:a.queueNumber})]},a.id)),t.map(a=>e.jsxs("div",{className:"admin-walkin-queue-item",onClick:()=>x(a.id),children:[e.jsxs("div",{className:"admin-walkin-queue-status-section",children:[e.jsx("div",{className:"admin-walkin-queue-status",children:"PENDING"}),e.jsx("div",{className:"admin-walkin-queue-date",children:new Date(a.timestamp).toLocaleTimeString([],{hour:"2-digit",minute:"2-digit"})})]}),e.jsx("div",{className:"admin-walkin-queue-applicant",children:`${a.firstName} ${a.lastName}`}),e.jsx("div",{className:"admin-walkin-queue-id",children:a.queueNumber})]},a.id))]})]})]})]})};o.__docgenInfo={description:"",methods:[],displayName:"AdminWalkInQueue"};const z={title:"Components/AdminWalkInQueue",component:o},l=()=>e.jsx(o,{});l.__docgenInfo={description:"",methods:[],displayName:"Default"};var k,j,g;l.parameters={...l.parameters,docs:{...(k=l.parameters)==null?void 0:k.docs,source:{originalSource:"() => <AdminWalkInQueue />",...(g=(j=l.parameters)==null?void 0:j.docs)==null?void 0:g.source}}};const H=["Default"];export{l as Default,H as __namedExportsOrder,z as default};
