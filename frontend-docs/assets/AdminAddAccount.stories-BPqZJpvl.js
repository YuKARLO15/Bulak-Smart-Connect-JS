import{j as e}from"./jsx-runtime-C52yb8KJ.js";import{r as c}from"./iframe-BEib9-8S.js";import{a as _,b as O}from"./NewUserInfo-DIrpYPvr.js";import{N as $}from"./NavSide-KxQEnR7l.js";import{u as F,a as I}from"./chunk-AYJ5UCUI-Dt5rzeq-.js";import"./AuthContext-C_BItzgJ.js";import"./createSvgIcon-M6UBD9v4.js";import"./identifier-Dgp6o8to.js";import"./DefaultPropsProvider-tGrWB7OP.js";import"./Close-DjuFfs6y.js";import"./Description-Du0lnqva.js";import"./Campaign-DBnq01Zp.js";const h=()=>{var N,w,b;const x=F(),p=I(),n=((N=p.state)==null?void 0:N.isModifying)||!1,i=((w=p.state)==null?void 0:w.userData)||null,A=(b=p.state)==null?void 0:b.userIndex,[s,u]=c.useState({username:"",contact:"",email:"",role:"",password:"",confirmPassword:"",firstName:"",lastName:""}),[t,f]=c.useState({}),[j,g]=c.useState(!1);c.useEffect(()=>{var o,a;if(n&&i){const r=i.name.split(" "),l=r[0]||"",S=r.slice(1).join(" ")||"",D=((o=i.contact)==null?void 0:o.replace("+63",""))||"";u({username:i.username||"",contact:D,email:i.email||"",role:((a=i.roles)==null?void 0:a[0])||"",password:"",confirmPassword:"",firstName:l,lastName:S})}},[n,i]);const m=o=>{const{name:a,value:r}=o.target;u(l=>({...l,[a]:r})),f(l=>({...l,[a]:""}))},U=o=>{o.preventDefault(),g(!0);try{let a={};if(Object.entries(s).forEach(([r,l])=>{n&&(r==="password"||r==="confirmPassword")||(!l||typeof l=="string"&&l.trim()==="")&&(a[r]="This field is required")}),(!n||s.password||s.confirmPassword)&&s.password!==s.confirmPassword&&(a.confirmPassword="Passwords do not match"),s.contact&&!/^\d{10}$/.test(s.contact)&&(a.contact="Contact number must be exactly 10 digits after +63"),s.email&&!s.email.includes("@")&&(a.email="Please enter a valid email address"),f(a),Object.keys(a).length===0){let r;n?(r=_(A,{name:`${s.firstName} ${s.lastName}`,status:i.status,roles:[s.role],image:i.image||"",username:s.username,email:s.email,contact:`+63${s.contact}`,...s.password?{password:s.password}:{}}),alert(r?"User updated successfully!":"Failed to update user. Please try again.")):(r=O(s),alert(r?"User added successfully!":"Failed to add user. Please try again.")),r&&x("/admin-user-management")}}catch(a){console.error("Error submitting form:",a),alert("An error occurred. Please try again.")}finally{g(!1)}},[C,E]=c.useState(!1);return e.jsxs("div",{children:[e.jsx($,{isSidebarOpen:C,setIsSidebarOpen:E}),e.jsx("h1",{children:n?"Modify User":"Add User"}),e.jsx("div",{className:"admin-add-user",children:e.jsxs("form",{className:"user-form",onSubmit:U,noValidate:!0,children:[e.jsxs("div",{className:"form-grid",children:[[{label:"Username",name:"username"},{label:"Email",name:"email",type:"email"},...n?[]:[{label:"Password",name:"password",type:"password"},{label:"Confirm Password",name:"confirmPassword",type:"password"}],{label:"First Name",name:"firstName"},{label:"Last Name",name:"lastName"}].map(({label:o,name:a,type:r="text"})=>e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:[o," ",e.jsx("span",{className:"required",children:"*"})]}),e.jsx("input",{type:r,name:a,placeholder:`Enter ${o}`,value:s[a],onChange:m,className:t[a]?"error-input":""}),t[a]&&e.jsx("p",{className:"error",children:t[a]})]},a)),n&&e.jsxs(e.Fragment,{children:[e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Password (leave blank to keep current)"}),e.jsx("input",{type:"password",name:"password",placeholder:"Enter new password",value:s.password,onChange:m,className:t.password?"error-input":""}),t.password&&e.jsx("p",{className:"error",children:t.password})]}),e.jsxs("div",{className:"form-group",children:[e.jsx("label",{children:"Confirm Password"}),e.jsx("input",{type:"password",name:"confirmPassword",placeholder:"Confirm new password",value:s.confirmPassword,onChange:m,className:t.confirmPassword?"error-input":""}),t.confirmPassword&&e.jsx("p",{className:"error",children:t.confirmPassword})]})]}),e.jsxs("div",{className:"form-group contact-split",children:[e.jsxs("label",{children:["Contact Number ",e.jsx("span",{className:"required",children:"*"})]}),e.jsxs("div",{className:"contact-input-wrapper",children:[e.jsx("input",{type:"text",value:"+63",disabled:!0,className:"country-code"}),e.jsx("input",{type:"text",name:"contact",placeholder:"Enter 10-digit number",value:s.contact,maxLength:"10",onChange:o=>{const a=o.target.value.replace(/\D/g,"").slice(0,10);u(r=>({...r,contact:a})),f(r=>({...r,contact:""}))},className:`phone-number ${t.contact?"error-input":""}`})]}),t.contact&&e.jsx("p",{className:"error",children:t.contact})]}),e.jsxs("div",{className:"form-group",children:[e.jsxs("label",{children:["User Role ",e.jsx("span",{className:"required",children:"*"})]}),e.jsxs("select",{name:"role",value:s.role,onChange:m,className:t.role?"error-input":"",children:[e.jsx("option",{value:"",children:"Select Role"}),e.jsx("option",{value:"Admin",children:"Admin"}),e.jsx("option",{value:"Manager",children:"Manager"}),e.jsx("option",{value:"Staff",children:"Staff"})]}),t.role&&e.jsx("p",{className:"error",children:t.role})]})]}),e.jsxs("div",{className:"form-actions",children:[e.jsx("button",{type:"submit",className:"submit-btn",disabled:j,children:j?n?"Updating User...":"Adding User...":n?"Update User":"Add User"}),e.jsx("button",{type:"button",className:"cancel-btn",onClick:()=>x("/admin-user-management"),children:"Cancel"})]})]})})]})};h.__docgenInfo={description:"",methods:[],displayName:"AdminAddUser"};const K={title:"Components/AdminAddAccount",component:h},d=()=>e.jsx(h,{});d.__docgenInfo={description:"",methods:[],displayName:"Default"};var v,y,P;d.parameters={...d.parameters,docs:{...(v=d.parameters)==null?void 0:v.docs,source:{originalSource:"() => <AdminAddAccount />",...(P=(y=d.parameters)==null?void 0:y.docs)==null?void 0:P.source}}};const Q=["Default"];export{d as Default,Q as __namedExportsOrder,K as default};
