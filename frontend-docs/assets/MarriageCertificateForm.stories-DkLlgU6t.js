import{j as e}from"./jsx-runtime-Ds-gkUgj.js";import{r as s}from"./index-CtvPRVHf.js";/* empty css                                */import{H as G}from"./HusbandForm-CBY8mR0a.js";import{W as V}from"./WifeForm-BUg9RJwY.js";import{M as K}from"./MarriageDetailsForm-CDPvGqDs.js";import{M as Q}from"./MarriageAffidavitForm-DFQSYJ5I.js";import{a as X,u as Z,b as ee}from"./ApplicationData-DCHunuve.js";import{B as b}from"./Box-DTRDwRT5.js";import{D as ae,a as te,b as ie}from"./DialogTitle-C19552pR.js";import{D as re}from"./DialogContentText-CbhOp8yQ.js";import{D as oe}from"./DialogActions-BFTUJfvS.js";import{B as l}from"./Button-CrXPkcH8.js";import{T as P}from"./Typography-B_acdWah.js";import{A as se}from"./Alert-15g-uXn2.js";import{P as ne}from"./Paper-DtQYlIIh.js";import{u as le}from"./chunk-AYJ5UCUI-CkRdRQ96.js";import"./createTheme-C6kIcmbg.js";import"./clsx-B-dksMZM.js";import"./extendSxProp-DharK51R.js";import"./useTheme-CryYIIKA.js";import"./DefaultPropsProvider-D010D3ru.js";import"./useSlot-D5ErQCYq.js";import"./CircularProgress-3zimLSxM.js";import"./createSimplePaletteValueFilter-5s3yMkVM.js";import"./Modal-ap6A8FnD.js";import"./createChainedFunction-BO_9K8Jh.js";import"./index-CTgio_F2.js";import"./index-W1kuYZ3C.js";import"./createSvgIcon-C90RuxAZ.js";const j=()=>{const[c,B]=s.useState(1),[r,y]=s.useState({}),[g,I]=s.useState({}),[n,T]=s.useState(""),[m,O]=s.useState(4),[W,$]=s.useState(!1),[ce,U]=s.useState(!1),[F,R]=s.useState(null),[z,v]=s.useState(!1),S=le();s.useEffect(()=>{const a=localStorage.getItem("isEditingMarriageForm")==="true",t=localStorage.getItem("selectedMarriageOption");t?(T(t),O(t==="Marriage License"?2:4),t==="Marriage Certificate"&&!a&&_()):S("/MarriageDashboard");const i=localStorage.getItem("editingMarriageType");if(a&&(!i||i===t)){const o=localStorage.getItem("marriageFormData");if(o)try{const d=JSON.parse(o);y(d),d.husbandCivilStatus==="Widowed"&&setShowHusbandWidowedFields(!0),d.wifeCivilStatus==="Widowed"&&setShowWifeWidowedFields(!0),console.log(`Loaded existing ${t} data for editing`)}catch(d){console.error("Error loading marriage form data for editing:",d)}}},[S]);const _=()=>{try{const a=X("Marriage License");if(a&&a.length>0){a.sort((i,o)=>new Date(o.date)-new Date(i.date));const t=a[0];t.formData&&(U(!0),R(t),v(!0))}}catch(a){console.error("Error checking for previous license data:",a)}},H=()=>{y(F.formData),$(!0),v(!1),console.log("Using data from previous Marriage License:",F.id)},J=()=>{v(!1),console.log("User chose to fill out a new form")},C=a=>{const{name:t,value:i,type:o,checked:d}=a.target;y(f=>({...f,[t]:o==="checkbox"?d:i})),g[t]&&I(f=>({...f,[t]:""}))},Y={1:["husbandFirstName","husbandLastName","husbandBirthMonth","husbandBirthDay","husbandBirthYear","husbandBirthCity","husbandBirthProvince","husbandBirthCountry","husbandSex","husbandFatherFirstName","husbandFatherLastName","husbandMotherFirstName","husbandMotherLastName","husbandStreet","husbandCity","husbandProvince","husbandCivilStatus","husbandCountry","husbandReligion","husbandCitizenship","husbandBarangay","husbandFatherCitizenship","husbandMotherCitizenship","waliFirstName","waliLastName","waliRelationship","waliStreet","waliCity","waliProvince","waliCountry","waliBarangay","husbandAge"],2:["wifeFirstName","wifeLastName","wifeBirthMonth","wifeBirthDay","wifeBirthYear","wifeBirthCity","wifeBirthProvince","wifeBirthCountry","wifeSex","wifeFatherFirstName","wifeFatherLastName","wifeMotherFirstName","wifeMotherLastName","wifeStreet","wifeCity","wifeProvince","wifeCivilStatus","wifeCountry","wifeReligion","wifeCitizenship","wifeBarangay","wifeFatherCitizenship","wifeMotherCitizenship","wifewaliFirstName","wifewaliLastName","wifewaliRelationship","wifewaliStreet","wifewaliCity","wifewaliProvince","wifewaliCountry","wifewaliBarangay","wifeAge"],3:["marriageOffice","marriageBarangay","marriageCity","marriageProvince","marriageCountry","marriageMonth","marriageDay","marriageYear","marriageTime"],4:["witness1FirstName","witness1LastName","witness1Address","witness2FirstName","witness2LastName","witness2Address"]},q=()=>{var t;const a={};return(t=Y[c])==null||t.forEach(i=>{(!r[i]||r[i].toString().trim()==="")&&(a[i]="This field is required")}),I(a),Object.keys(a).length===0},D=()=>{if(q())c<m?B(a=>a+1):N();else{const a=document.querySelector(`[name="${Object.keys(g)[0]}"]`);a&&a.scrollIntoView({behavior:"smooth",block:"center"})}},M=()=>{B(a=>a-1)},N=a=>{a&&a.preventDefault&&a.preventDefault();try{console.log("==== MARRIAGE FORM SUBMISSION ====");const t=localStorage.getItem("isEditingMarriageForm")==="true",i=localStorage.getItem("currentEditingApplicationId");console.log("Is editing mode?",t),console.log("Editing ID:",i);let o;t&&i?(o=i,console.log("Using existing ID for edit:",o)):(o=n==="Marriage License"?"ML-"+Date.now().toString().slice(-6):"MC-"+Date.now().toString().slice(-6),console.log("Generated new ID:",o));const f=new Date().toLocaleDateString("en-US",{year:"numeric",month:"numeric",day:"numeric"});let u;if(t&&i){const p=JSON.parse(localStorage.getItem("applications")||"[]").find(w=>w.id===i);if(!p){console.error("Could not find application with ID:",i),alert("Error: Could not find the application you are trying to edit.");return}console.log("Found existing application:",p),u={id:o,type:n||p.type,applicationType:"Modified Application",date:p.date||f,status:p.status||"Pending",message:`Application for ${n||"marriage"} between ${r.husbandFirstName||""} ${r.husbandLastName||""} and ${r.wifeFirstName||""} ${r.wifeLastName||""}`,formData:{...r,applicationId:o,certificateType:n,lastUpdated:new Date().toISOString()},lastModified:new Date().toISOString()}}else u={id:o,type:n||"Marriage Certificate",applicationType:"New Application",date:f,status:"Pending",message:`Application for ${n||"marriage"} between ${r.husbandFirstName||""} ${r.husbandLastName||""} and ${r.wifeFirstName||""} ${r.wifeLastName||""}`,formData:{...r,applicationId:o,certificateType:n,lastUpdated:new Date().toISOString()}};console.log("Final application data to submit:",u);let h;if(t&&i){const L=JSON.parse(localStorage.getItem("applications")||"[]");console.log("Applications before update:",L.map(w=>w.id)),h=Z(i,u);const p=JSON.parse(localStorage.getItem("applications")||"[]");console.log("Applications after update:",p.map(w=>w.id)),console.log("Update result:",h)}else h=ee(u),console.log("Add result:",h);if(!h){console.error("Failed to save application"),alert("There was an error saving your application. Please try again.");return}localStorage.removeItem("isEditingMarriageForm"),localStorage.removeItem("editingMarriageType"),localStorage.removeItem("currentEditingApplicationId"),localStorage.removeItem("marriageFormData"),window.dispatchEvent(new Event("storage")),S(n==="Marriage License"?"/MarriageLicenseApplication":"/MarriageCertificateApplication")}catch(t){console.error("Error submitting form:",t),alert("There was an error submitting your application. Please try again.")}};return e.jsxs(b,{className:"MarriageCertificateFormContainer",children:[e.jsxs(ae,{open:z,"aria-labelledby":"previous-data-dialog-title","aria-describedby":"previous-data-dialog-description",PaperProps:{sx:{borderRadius:"10px",maxWidth:"500px",width:"100%"}},children:[e.jsx(te,{id:"previous-data-dialog-title",sx:{backgroundColor:"#184a5b",color:"white",fontWeight:600},children:"Use Previous Marriage License Data?"}),e.jsx(ie,{sx:{padding:"24px"},children:e.jsxs(re,{id:"previous-data-dialog-description",sx:{color:"#333333",fontSize:"16px",marginBottom:"10",marginTop:"30px"},children:["We found a previous Marriage License application submitted on ",F&&new Date(F.date).toLocaleDateString(),". Would you like to use that information to fill out this form?"]})}),e.jsxs(oe,{sx:{padding:"16px 24px",justifyContent:"space-between"},children:[e.jsx(l,{onClick:J,sx:{backgroundColor:"#e0e0e0",color:"#333333",padding:"4px 10px",fontWeight:500},children:"No, I'll fill it out again"}),e.jsx(l,{onClick:H,autoFocus:!0,sx:{backgroundColor:"#184a5b",color:"white",padding:"4px 10px",fontWeight:500},children:"Yes, use my previous information"})]})]}),e.jsxs(P,{variant:"h4",className:"MarriageCertificateFormTitle",children:[n||"Marriage"," Application Form"]}),W&&e.jsx(se,{severity:"info",sx:{mb:2},children:"Using data from your previous Marriage License application. Please verify all information is still correct."}),e.jsxs(ne,{className:"MarriageCertificateForm",elevation:3,children:[c===1&&e.jsxs(e.Fragment,{children:[e.jsx(G,{formData:r,handleChange:C,errors:g}),e.jsx(l,{variant:"contained",onClick:D,className:"MarriageCertificateFormButton",children:"Next"})]}),c===2&&e.jsxs(e.Fragment,{children:[e.jsx(V,{formData:r,handleChange:C,errors:g}),e.jsx(l,{variant:"contained",onClick:M,className:"MarriageCertificateFormButton",children:"Previous"}),e.jsx(l,{variant:"contained",onClick:m===2?N:D,className:"MarriageCertificateFormButton",children:m===2?"Submit":"Next"})]}),c===3&&m>2&&e.jsxs(e.Fragment,{children:[e.jsx(K,{formData:r,handleChange:C,errors:g}),e.jsx(l,{variant:"contained",onClick:M,className:"MarriageCertificateFormButton",children:"Previous"}),e.jsx(l,{variant:"contained",onClick:D,className:"MarriageCertificateFormButton",children:"Next"})]}),c===4&&m>2&&e.jsxs(e.Fragment,{children:[e.jsx(Q,{formData:r,handleChange:C,errors:g}),e.jsx(l,{variant:"contained",onClick:M,className:"MarriageCertificateFormButton",children:"Previous"}),e.jsx(l,{variant:"contained",onClick:N,className:"MarriageCertificateFormButton",children:"Submit"})]}),e.jsxs(b,{className:"FormProgressContainer",children:[e.jsxs(P,{variant:"body2",children:["Step ",c," of ",m]}),e.jsx(b,{className:"FormProgressBar",children:e.jsx(b,{className:"FormProgressFill",sx:{width:`${c/m*100}%`}})})]})]})]})};j.__docgenInfo={description:"",methods:[],displayName:"MarriageCertificateForm"};const Ue={title:"Components/MarriageCertificateForm",component:j},x=()=>e.jsx(j,{});x.__docgenInfo={description:"",methods:[],displayName:"Default"};var A,E,k;x.parameters={...x.parameters,docs:{...(A=x.parameters)==null?void 0:A.docs,source:{originalSource:"() => <MarriageCertificateForm />",...(k=(E=x.parameters)==null?void 0:E.docs)==null?void 0:k.source}}};const Re=["Default"];export{x as Default,Re as __namedExportsOrder,Ue as default};
