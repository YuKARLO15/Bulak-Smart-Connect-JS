import{j as o}from"./jsx-runtime-Ds-gkUgj.js";import{r as a}from"./index-CtvPRVHf.js";import{F as q}from"./ForgotPassword-CuwFV8yH.js";import{u as O}from"./AuthContext-DROsejNy.js";import"./api-DLOjWVc5.js";import{C as z}from"./Card-5N8AYhSH.js";import{T as E}from"./Typography-B_acdWah.js";import{B as I}from"./Box-DTRDwRT5.js";import{F as D}from"./FormControl-ejMFLZfM.js";import{F as A,T as M}from"./TextField-x5bq30C3.js";import{c as _}from"./clsx-B-dksMZM.js";import{u as G}from"./useTheme-CryYIIKA.js";import{u as J,s as K,c as Q,m as X}from"./DefaultPropsProvider-D010D3ru.js";import{c as Y}from"./createSimplePaletteValueFilter-5s3yMkVM.js";import{g as Z,b as ee,q as F,a as k,d as B}from"./createTheme-C6kIcmbg.js";import{i as V}from"./CircularProgress-3zimLSxM.js";import{F as re}from"./FormControlLabel-V-VWOkG2.js";import{C as oe}from"./Checkbox-BnloHra9.js";import{B as se}from"./Button-CrXPkcH8.js";import{u as te}from"./chunk-AYJ5UCUI-CkRdRQ96.js";function ae(e){return ee("MuiLink",e)}const ne=Z("MuiLink",["root","underlineNone","underlineHover","underlineAlways","button","focusVisible"]),le=({theme:e,ownerState:r})=>{const s=r.color,t=F(e,`palette.${s}.main`,!1)||F(e,`palette.${s}`,!1)||r.color,i=F(e,`palette.${s}.mainChannel`)||F(e,`palette.${s}Channel`);return"vars"in e&&i?`rgba(${i} / 0.4)`:k(t,.4)},R={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},ie=e=>{const{classes:r,component:s,focusVisible:t,underline:i}=e,d={root:["root",`underline${B(i)}`,s==="button"&&"button",t&&"focusVisible"]};return Q(d,ae,r)},ce=K(E,{name:"MuiLink",slot:"Root",overridesResolver:(e,r)=>{const{ownerState:s}=e;return[r.root,r[`underline${B(s.underline)}`],s.component==="button"&&r.button]}})(X(({theme:e})=>({variants:[{props:{underline:"none"},style:{textDecoration:"none"}},{props:{underline:"hover"},style:{textDecoration:"none","&:hover":{textDecoration:"underline"}}},{props:{underline:"always"},style:{textDecoration:"underline","&:hover":{textDecorationColor:"inherit"}}},{props:({underline:r,ownerState:s})=>r==="always"&&s.color!=="inherit",style:{textDecorationColor:"var(--Link-underlineColor)"}},...Object.entries(e.palette).filter(Y()).map(([r])=>({props:{underline:"always",color:r},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette[r].mainChannel} / 0.4)`:k(e.palette[r].main,.4)}})),{props:{underline:"always",color:"textPrimary"},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette.text.primaryChannel} / 0.4)`:k(e.palette.text.primary,.4)}},{props:{underline:"always",color:"textSecondary"},style:{"--Link-underlineColor":e.vars?`rgba(${e.vars.palette.text.secondaryChannel} / 0.4)`:k(e.palette.text.secondary,.4)}},{props:{underline:"always",color:"textDisabled"},style:{"--Link-underlineColor":(e.vars||e).palette.text.disabled}},{props:{component:"button"},style:{position:"relative",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none","&::-moz-focus-inner":{borderStyle:"none"},[`&.${ne.focusVisible}`]:{outline:"auto"}}}]}))),ue=a.forwardRef(function(r,s){const t=J({props:r,name:"MuiLink"}),i=G(),{className:d,color:n="primary",component:h="a",onBlur:f,onFocus:g,TypographyClasses:b,underline:C="always",variant:y="inherit",sx:m,...p}=t,[S,x]=a.useState(!1),v=u=>{V(u.target)||x(!1),f&&f(u)},j=u=>{V(u.target)&&x(!0),g&&g(u)},L={...t,color:n,component:h,focusVisible:S,underline:C,variant:y},N=ie(L);return o.jsx(ce,{color:n,className:_(N.root,d),classes:b,component:h,onBlur:v,onFocus:j,ref:s,ownerState:L,variant:y,...p,sx:[...R[n]===void 0?[{color:n}]:[],...Array.isArray(m)?m:[m]],style:{...p.style,...C==="always"&&n!=="inherit"&&!R[n]&&{"--Link-underlineColor":le({theme:i,ownerState:L})}}})});function de({onLogin:e}){const[r,s]=a.useState(""),[t,i]=a.useState(""),[d,n]=a.useState(!1),[h,f]=a.useState(""),[g,b]=a.useState(!1),[C,y]=a.useState(""),[m,p]=a.useState(""),[S,x]=a.useState(!1),v=te(),{login:j,hasRole:L,isStaff:N}=O(),u=()=>x(!0),H=()=>x(!1),U=async l=>{var P,T,$;if(l.preventDefault(),W())try{console.log("Sending login request with:",{email:r,password:t});const{success:c,user:w}=await j(r,t);console.log("Login successful:",c),c?w&&((P=w.roles)!=null&&P.includes("staff")||(T=w.roles)!=null&&T.includes("admin")||($=w.roles)!=null&&$.includes("super_admin"))?(console.log("User has admin role - navigating to AdminHome"),v("/AdminHome")):(console.log("User is a regular user - navigating to Home"),v("/Home")):p("Login failed. Please check your credentials.")}catch(c){console.error("Login error:",c),c.response?(console.log("Error status:",c.response.status),console.log("Error data:",c.response.data),p(c.response.data.message||"Invalid credentials")):p("An error occurred during login. Please try again.")}},W=()=>{let l=!0;return!r||!/\S+@\S+\.\S+/.test(r)?(n(!0),f("Please enter a valid email address."),l=!1):(n(!1),f("")),!t||t.length<6?(b(!0),y("Password must be at least 6 characters long."),l=!1):(b(!1),y("")),l};return o.jsxs(z,{className:"LogInCardContainer",children:[o.jsx(E,{variant:"h4",className:"LogInTitle",children:"LOG IN"}),o.jsxs(I,{component:"form",onSubmit:U,noValidate:!0,className:"LogInForm",children:[o.jsxs(D,{children:[o.jsx(A,{htmlFor:"email",className:"LogInLabel",children:"Email"}),o.jsx(M,{error:d,helperText:h,id:"email",type:"email",name:"email",placeholder:"your@email.com",autoComplete:"email",autoFocus:!0,required:!0,fullWidth:!0,variant:"outlined",className:`TextField ${d?"error":""}`,value:r,onChange:l=>s(l.target.value)})]}),o.jsxs(D,{children:[o.jsxs(I,{className:"PasswordContainer",children:[o.jsx(A,{htmlFor:"password",className:"LogInLabel",children:"Password"}),o.jsx(ue,{component:"button",type:"button",onClick:u,variant:"body2",className:"ForgotPassword",children:"Forgot your password?"})]}),o.jsx(M,{error:g,helperText:C,name:"password",placeholder:"••••••",type:"password",id:"password",autoComplete:"current-password",required:!0,fullWidth:!0,className:`TextField ${g?"error":""}`,value:t,onChange:l=>i(l.target.value)})]}),o.jsx(re,{control:o.jsx(oe,{value:"remember",color:"#184a5b"}),label:"Remember me",className:"RememberMe"}),o.jsx(q,{open:S,handleClose:H}),o.jsx(se,{type:"submit",fullWidth:!0,variant:"contained",className:"LoginButton",children:"Log In"}),m&&o.jsx(E,{color:"error",children:m})]})]})}de.__docgenInfo={description:"",methods:[],displayName:"LogInCard"};export{de as L};
