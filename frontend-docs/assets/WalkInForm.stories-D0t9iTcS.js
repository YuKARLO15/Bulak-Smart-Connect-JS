import{j as e}from"./jsx-runtime-B2zRRsyC.js";import{r}from"./iframe-DFJbmHxV.js";import{N as w}from"./NavSide-J-SsnF1r.js";import{q as A}from"./queueService-BpOaP1T5.js";import{u as Q}from"./AuthContext-DJC-PDlw.js";import{u as V}from"./chunk-AYJ5UCUI-Dkxbd2KT.js";import"./createSvgIcon-DyFVt9JA.js";import"./clsx-B-dksMZM.js";import"./DefaultPropsProvider-D8NTv0Cq.js";import"./identifier-DkWYEeeb.js";import"./Close-VfqxqJka.js";import"./Description-BSyaQf5x.js";import"./Campaign-G9xfBV_Z.js";import"./index-xsH4HHeE.js";import"./api-DR_qaoiX.js";const _=s=>{if(typeof s=="string"&&s.startsWith("WK"))return s;const t=s!=null&&s.includes("-")?s.split("-")[1]:s,d=parseInt(t,10)||0;return`WK${String(d).padStart(3,"0")}`},f=()=>{const{user:s}=Q();V();const[t,d]=r.useState({lastName:"",firstName:"",middleInitial:"",address:"",phoneNumber:"",reasonOfVisit:""}),[N,S]=r.useState(!1),[B,W]=r.useState(""),[k,y]=r.useState(!0),[m,b]=r.useState(!1),[G,D]=r.useState(!1),[n,C]=r.useState(null);s!=null&&s.id,r.useEffect(()=>{const i={lastName:s.lastName||"",firstName:s.firstName||"",middleInitial:s.middleName||"",address:s.address||"",phoneNumber:s.contactNumber||""};C(i)},[]),r.useEffect(()=>{m&&n&&d({...t,lastName:n.lastName,firstName:n.firstName,middleInitial:n.middleInitial,address:n.address,phoneNumber:n.phoneNumber})},[m,n]);const o=i=>{const{name:a,value:c}=i.target;d({...t,[a]:c})},x=i=>{b(i),y(!1),D(!0),W(i?"self":"other")},O=async i=>{i.preventDefault();try{console.log("Creating queue for authenticated user:",s);const a=(s==null?void 0:s.id)||null,c=!m;console.log("Queue creation with userId:",a,"isGuest:",c);const I=await A.createQueue({userId:a,isGuest:c,firstName:t.firstName,lastName:t.lastName,middleInitial:t.middleInitial||"",address:t.address||"",phoneNumber:t.phoneNumber||"",reasonOfVisit:t.reasonOfVisit,appointmentType:t.reasonOfVisit}),g=_(I.queue.queueNumber),u={id:g,dbId:I.queue.id,queueNumber:g,date:new Date().toLocaleDateString("en-US",{month:"2-digit",day:"2-digit",year:"2-digit"}),userData:t,appointmentType:t.reasonOfVisit,isUserQueue:!0,userId:a,isGuest:!m};localStorage.setItem(`userQueue_${a}`,JSON.stringify(u));try{const h=localStorage.getItem(`userQueues_${a}`);let p=h?JSON.parse(h):[];Array.isArray(p)||(p=[]),p.push(u),localStorage.setItem(`userQueues_${a}`,JSON.stringify(p)),localStorage.setItem("userQueue",JSON.stringify(u))}catch(h){console.error("Error updating user queues:",h),localStorage.setItem(`userQueues_${a}`,JSON.stringify([u]))}window.location.href="/WalkInDetails"}catch(a){console.error("Error creating queue:",a)}};return k?e.jsx("div",{className:"WalkInFormContainerWalkIn",children:e.jsx("div",{className:"DialogOverlay",children:e.jsxs("div",{className:"DialogBox",children:[e.jsx("h3",{children:"Account Verification"}),e.jsx("p",{children:"Are you the owner of this account?"}),e.jsxs("div",{className:"DialogActions",children:[e.jsx("button",{className:"DialogBtn YesBtn",onClick:()=>x(!0),children:"Yes, use my details"}),e.jsx("button",{className:"DialogBtn NoBtn",onClick:()=>x(!1),children:"No, enter new details"})]})]})})}):e.jsxs("div",{className:`WalkInFormContainerWalkIn ${N?"sidebar-open":""}`,children:[e.jsx(w,{isSidebarOpen:N,setIsSidebarOpen:S}),e.jsx("div",{className:"FormHeaderWalkIn",children:e.jsx("h1",{children:"Walk - In"})}),e.jsxs("div",{className:"FormTitleWalkIn",children:[e.jsx("h2",{children:"Walk-In Form"}),e.jsx("p",{children:"Please fill in the details below:"})]}),e.jsx("div",{className:"WalkInForm",children:e.jsxs("form",{onSubmit:O,children:[e.jsxs("div",{className:"FormRowWalkIn",children:[e.jsxs("div",{className:"FormGroupWalkIn",children:[e.jsx("label",{htmlFor:"lastName",children:"Last Name"}),e.jsx("input",{type:"text",id:"lastName",name:"lastName",value:t.lastName,onChange:o,required:!0})]}),e.jsxs("div",{className:"FormGroupWalkIn",children:[e.jsx("label",{htmlFor:"firstName",children:"First Name"}),e.jsx("input",{type:"text",id:"firstName",name:"firstName",value:t.firstName,onChange:o,required:!0})]}),e.jsxs("div",{className:"FormGroupWalkIn SmallWalkIn",children:[e.jsx("label",{htmlFor:"middleInitial",children:"Middle Initial"}),e.jsx("input",{type:"text",id:"middleInitial",name:"middleInitial",maxLength:"1",value:t.middleInitial,onChange:o})]})]}),e.jsxs("div",{className:"FormRowWalkIn",children:[e.jsxs("div",{className:"FormGroupWalkIn",children:[e.jsx("label",{htmlFor:"address",children:"Address"}),e.jsx("input",{type:"text",id:"address",name:"address",value:t.address,onChange:o,required:!0})]}),e.jsxs("div",{className:"FormGroupWalkIn",children:[e.jsx("label",{htmlFor:"phoneNumber",children:"Phone Number"}),e.jsx("input",{type:"tel",id:"phoneNumber",name:"phoneNumber",value:t.phoneNumber,onChange:o,required:!0})]})]}),e.jsx("div",{className:"FormRowWalkIn",children:e.jsxs("div",{className:"FormGroupWalkIn",children:[e.jsx("label",{htmlFor:"reasonOfVisit",children:"Reason of Visit"}),e.jsxs("select",{id:"reasonOfVisit",name:"reasonOfVisit",value:t.reasonOfVisit,onChange:o,required:!0,children:[e.jsx("option",{value:"",disabled:!0,children:"Select reason"}),e.jsx("option",{value:"Birth Certificate",children:"Birth Certificate"}),e.jsx("option",{value:"Marriage Certificate",children:"Marriage Certificate"}),e.jsx("option",{value:"Death Certificate",children:"Death Certificate"}),e.jsx("option",{value:"Inqury",children:"Inqury"})]})]})}),e.jsx("div",{className:"FormActionsWalkIn",children:e.jsx("button",{type:"submit",className:"ConfirmBtnWalkIn",children:"Confirm"})})]})})]})};f.__docgenInfo={description:"",methods:[],displayName:"WalkInForm"};const Z={title:"Components/WalkInForm",component:f},l=()=>e.jsx(f,{});l.__docgenInfo={description:"",methods:[],displayName:"Default"};var j,v,F;l.parameters={...l.parameters,docs:{...(j=l.parameters)==null?void 0:j.docs,source:{originalSource:"() => <WalkInForm />",...(F=(v=l.parameters)==null?void 0:v.docs)==null?void 0:F.source}}};const ee=["Default"];export{l as Default,ee as __namedExportsOrder,Z as default};
